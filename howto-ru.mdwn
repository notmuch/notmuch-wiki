[notmuch/](https://notmuchmail.org/)
 
![enter image description here](https://notmuchmail.org/notmuch-logo.png) <a name="1"></a> Как …
-----

Несколько советов о том, что полезного можно сделать с notmuch, а также с различные "внешними" notmuch утилитами.
I.	[Как...](#1)
1.	[Получить письмо](#2)
2.	[Отправить письмо](#3) 
3.	[Синхронизировать теги notmuch и метки maildir](#4) 
4.	[Использовать notmuch с python](#5)
5.	[Использовать notmuch с Mutt](#6)
6.	[Автоматическая замена тегов в базе данных (т.е., при обновлении версий)](#7)
7.	[Работа с mbox и другими форматами](#8) 
8.	[Воспользуйтесь специальными тегами для notmuch](#9)
9.	[Список всех ваших gpg-шифрованых писем](#10)

<a name="2"></a>

####Получить письмо

Notmuch не получает почту для вас. Для этого вам нужно использовать внешнюю утилиту пересылки электронной почты. Некоторые рекомендуемые утилиты перечислены ниже.
Notmuch требует, чтобы каждое отдельное сообщение было в отдельном файле. Хорошо поддерживаемый [maildir](http://cr.yp.to/proto/maildir.html) или форматы хранения "mh"-стиля совместимы с notmuch. В принципе любая установка, в которой каждое письмо в собственном файле, будет работать. Более старые mbox форматы хранения почты не поддерживаются, но, к  счастью, очень легко [конвертировать mbox в maildir](https://notmuchmail.org/howto/#mbox) . Следующие утилиты поддерживают такие форматы:
•	[offlineimap](http://offlineimap.org/) - весьма полезен и тщательно протестирован, он также предлагает удобное средство, которое пригодится чуть позже в нашей установке. Также поддерживает "presynchook" и "postsynchook" команды,  которые будут запускаться при синхронизации. Укажите postsynchook в скрипте, который запускается при каждой синхронизации, и который будет делать автоматическое обновление и теггирование вашей notmuch базы данных.
•	[mbsync](http://isync.sourceforge.net/)
•	[getmail](http://pyropus.ca/software/getmail/)
•	[fetchmail](http://www.fetchmail.info/)
•	[muchsync](http://www.muchsync.org/) - репликации и синхронизации баз данных notmuch (письма и теги) по машинам
Более исчерпывающий перечень софта,  с которым работает [notmuch](https://notmuchmail.org/software/) и  начальное тегирование страницы за более подробной информацией о [начальной расстановке](https://notmuchmail.org/initial_tagging/) тегов сообщений.  

####<a name="3"></a>Отправить письмо
Notmuch не отправляет вашу почту. Фронтенды (MUAs) делают это, которые используют notmuch. Часто эти MUAs используют sendmail (8) для отправки почты. 
Если вы предпочитаете более простое решение, как msmtp, вначале [установите и настройте msmtp.](http://msmtp.sourceforge.net/)
Затем создайте символьную ссылку так, чтобы вызывался msmtp вместо sendmail при нажатии клавиши быстрого доступа, чтобы отправить сообщение.

    $ sudo ln -s /usr/bin/msmtp /usr/sbin/sendmail

####<a name="4"></a>Синхронизировать теги notmuch и метки maildir 
notmuch имеет возможность синхронизации maildir меток и соответствующих тегов в обоих направлениях. Для получения дополнительной информации о maildir метках, перейдите на страницу [maildir](http://cr.yp.to/proto/maildir.html) , и соответствующих тегов см файл конфигурации notmuch. Эта функция включена по умолчанию, но если вам она не нужна, просто отключите ее с помощью 'notmuch config' команды:

$ notmuch config set maildir.synchronize_flags false

Метки maildir могут, в свою очередь, быть синхронизированы с метками IMAP другим инструментом, как offlineimap.
По соображениям безопасности, а также из-за того, что ?notmuch не поддерживает удаление jgthfwbq, notmuch не синхронизирует "мусорные" метки. Для обсуждения этой темы, пожалуйста, обратитесь к списку рассылки.
####<a name="5"></a>Использовать notmuch с python
Просмотрите страницу [Notmuch Library Language Bindings](https://notmuchmail.org/bindings/) .
####<a name="6"></a>Использовать notmuch с Mutt
Просмотрите [notmuch-mutt.](https://notmuchmail.org/notmuch-mutt/)

####<a name="7"></a>Автоматическая замена тегов в базе (т.е., при обновлении версии)

Некоторые версии notmuch включают новые автоматические теги (например, между 0.3 и 0.10, была добавлена автоматическая расстановка тегов в шифрованных и кодированных сообщениях).  Однако, для пользователей, работающих с базами данных, созданных в более ранних версиях notmuch, эти теги отсутствуют в существующих ранее сообщениях и должны быть добавлены. Можно сделать это следующим образом:



    $ notmuch dump --output=$HOME/out.nm
    $ mv ~/Mail/.notmuch ~/.notmuch.bak
    $ notmuch new
    $ notmuch tag -inbox -unread '*'
    $ notmuch restore --accumulate --input=$HOME/out.nm


В этот момент необходимо выполнить проверку вменяемости по тегам, и если все правильно объединено, каталог ~/.notmuch.bak  применяется однократно, как и $HOME/out.nm.

####<a name="8"></a>Работа с mbox и другими форматами

notmuch сам по себе не может обрабатывать не-maildir архивы почты. Один из инструментов для решения этой проблемы называется mb2md. Предполагая, mbox in ~/test.mbox и архивы почты в ~/Mail, вызов  будет выглядеть так

    $ mb2md -s ~/test.mbox -d ~/Mail/mynewmaildirname

Обратите внимание, что необходимо указание пути для -s и -d. Это создаст новый maildir в ~/Mail/mynewmaildirname из mbox в~/test.mbox.

Часто форматы более запутанны, однако. Многие списки предоставляют почти-но-не -mbox формат, который производит mailman, как можно видеть, например, [здесь](http://lists.xapian.org/pipermail/xapian-devel/). Эти файлы могут быть преобразованы с некоторым успехом в mbox с помощью скрипта, найденного [здесь](http://www.hermann-uwe.de/blog/converting-mailman-gzipd-text-archive-files-to-proper-mbox-files), и из mbox к maildir, как выше показано.

Тем не менее, многие из этих списков также имеют gmane версию, которая, с места расположения, архивирует с намного лучщими результатами, чем беспорядочный mailman вывод. Использование инструкции с сайта [Gmane](http://gmane.org/export.php) , мы можем скачать файл mbox, которые мы можем затем преобразовать в maildir,  используя mb2md или другую утилиту.

Пожалуйста, обратите внимание, что почта доставленная Postfix будет иметь конверт заголовки, которые могут привести к тому, что notmuch будет жаловаться на файлы "single-message mbox ". Удаление первой строки из сообщения или пропуская ее через reformail решит эту проблему.


####<a name="9"></a>Воспользуйтесь специальными тегами для notmuch

Просмотрите [специальные теги для notmuch.](https://notmuchmail.org/special-tags/)


####<a name="10"></a>Список всех ваших gpg-шифрованых писем

Если вы не против замены зашифрованных сообщений электронной почты с версиями cleartext и их переиндексацией, есть некоторые скрипты, делающие это в [github](https://github.com/mmehnert/maildir-decrypt) . Это имело бы смысл в сценарии, где вы зашифруете ваш жесткий диск в любом случае и осознаете риски безопасности (и пока notmuch может индексировать зашифрованные письма сам по себе).

Ссылки: [excluding](https://notmuchmail.org/excluding/) [index](https://notmuchmail.org/)
*Последний раз редактировалось Вс Февраль 21 12:51:44 2016*
Перевод предоставлен службой фильтрации [Everycloud](http://www.everycloudtech.com/)
